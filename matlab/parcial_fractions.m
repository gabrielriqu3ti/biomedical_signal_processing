% PTC3456 - Processamento de Sinais Biológicos 
% Aula 4

%% Exercício 1

% 100y[n]+20y[n-1]+9y[n-2]+44y[n-3]+16y[n-4] = 500x[n]+68.56x[n-1]+260.56x[n-2]-453.36x[n-3]-100x[n-4]-45x[n-5]-220x[n-6]-80x[n-7]

% Y(z)(100 + 20z^(-1) + 9z^(-2) + 44z^(-3) + 16z^(-4)) = X(z)(500 + 68.56z^(-1) + 260.56z^(-2) - 453.36z^(-3) + 100z^(-4) - 45z^(-5) - 220z^(-6) - 80z^(-7))

%        Y(z)   500 + 68.56z^(-1) + 260.56z^(-2) - 453.36z^(-3) + 100z^(-4) - 45z^(-5) - 220z^(-6) - 80z^(-7)
% H(z) = ---- = -----------------------------------------------------------------------------------------------
%        X(z)   100 + 20z^(-1) + 9z^(-2) + 44z^(-3) + 16z^(-4)


%        Y(z)   500 + 68.56z^(-1) + 260.56z^(-2) - 453.36z^(-3) + 100z^(-4) - 45z^(-5) - 220z^(-6) - 80z^(-7)
% H(z) = ---- = -----------------------------------------------------------------------------------------------
%        X(z)   100 + 20z^(-1) + 9z^(-2) + 44z^(-3) + 16z^(-4)


b = [500, 68.56, 260.56, -453.36, 100, -45, -220, -80];
a = [100, 20, 9, 44, 16];

[r, p ,k] = residuez(b, a);

% disp('Resíduos')
% disp(r)
% r =  0.0141 - 0.0079i
%      0.0141 + 0.0079i
%      -15.7298
%       8.2016

% disp('Polos')
% disp(p)
% p = 0.4000 + 0.6928i
%     0.4000 - 0.6928i
%     -0.5000
%     -0.5000

% disp('Constante')
% disp(k)
% k = 12.5000
%     0         
%     0   
%     -5.0000


% Assim,
%           0.0141 - 0.0079i            0.0141 + 0.0079i    
% H(z) = ------------------------ + ------------------------
%        1 -(0.4 + 0.6928i)z^(-1)   1 -(0.4 - 0.6928i)z^(-1)
%
%             -15.7298         8.2016
%        + -------------- + -------------- + 12.5 - 5 z^(-3)
%          1 + 0.5 z^(-1)   1 + 0.5 z^(-1)
% 





%% Exercício 2 

% y[n] + y[n-1] - 0.75 y[n-2] = x[n] + x[n-2]

% Y(z)(1 + z^(-1) + 0.75 z^(-2)) = X(z)(1 + z^(-2))

%        Y(z)       1 + z^(-2)
% H(z) = ---- = -------------------
%        X(z)   1 + z^(-1) + z^(-2)

b = [1, 0, 1];
a = [1, 1, -0.75];

[r, p, k] = residuez(b, a);

% r = 1.0833
%     1.2500

% p = -1.5000
%     0.5000

% k = -1.3333

%        Y(z)       1.0833           1.25
% H(z) = ---- = ------------- + ------------- - 1.3333
%        X(z)   1 + 1.5z^(-1)   1 - 0.5z^(-1)

%% Exerecício 3

% y[n] + 5.2 y[n-1] + y[n-2] = 96 x[n]

% Y(z)(1 + 5.2 z^(-1) + z^(-2) = 96 X(z)

%        Y(z)             96                   100             4
% H(z) = ---- = ----------------------- = ------------ - --------------
%        X(z)   1 + 5.2 z^(-1) + z^(-2)   1 + 5 z^(-1)   1 + 0.2 z^(-1)

b = [96];
a = [1, 5.2, 1];

[r, p, k] = residuez(b, a);

